---
msktutil::chmodpath:     /bin/chmod
msktutil::configpath:    /etc/krb5.conf
msktutil::keytabpath:    /etc/krb5.keytab
msktutil::keytabmode:    '0640'
msktutil::user:          root
msktutil::group:         root
msktutil::packagename:   msktutil
msktutil::usereversedns: false
msktutil::installed:     present
msktutil::ensure:        present
msktutil::ensurecron:    present
msktutil::msktutilpath:  /sbin/msktutil
msktutil::cronstub:      /etc/cron.daily/msktutil
msktutil::keytabreplace: 60
msktutil::packages:
  - msktutil
msktutil::extraopts: "--service host/%{facts['hostname']} --service host/%{facts['fqdn']}"
msktutil::cronfiles:
  crontab:
    ensure:  file
    mode:    '0700'
    owner:   "%{mskutil::user}"
    path:    "%{mskutil::cronstub}"
    content: |+
      #!/bin/sh
      %{msktutil::msktutilpath} \
        ${dashn} \
        --auto-update \
        --auto-update-interval ${msktutil::keytabreplace} \
        --computer-name ${msktutil::myhostname} \
        --hostname ${msktutil::myfqdn} \
        %{msktutil::extraopts}

  cronoptions:
    ensure: absent
    path:   /etc/default/msktutil
